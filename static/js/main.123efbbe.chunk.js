(this.webpackJsonptextre=this.webpackJsonptextre||[]).push([[0],{147:function(e,t,n){},148:function(e,t,n){"use strict";n.r(t);var r=n(0),l=n(39),a=n(3);function c(e){var t=r.useRef(null),n=r.useCallback((function(n){t.current&&(t.current.disabled=!0,t.current.style.backgroundColor="red");var r=n.target.files;if(null!=r){for(var l=[],a=function(t){var n=r[t];l.push(n.text().then((function(t){console.log(t.length),e.registerSource(n.name,t)})))},c=0;c<r.length;c++)a(c);Promise.all(l).then((function(){t.current&&(t.current.disabled=!1,t.current.style.backgroundColor="")}))}}),[e]),l=r.useCallback((function(){e.onComplete()}),[e]);return r.createElement("div",null,r.createElement("h2",null,"Add a source ",r.createElement("small",null,"Select your file(s)")),r.createElement("input",{type:"file",multiple:!0,onChange:n,accept:".txt"}),r.createElement("br",null),r.createElement("button",{ref:t,onClick:l},"Close"))}var o=n(40);function u(e){var t=r.useRef(null),n=r.useRef(null),l=r.useRef(null),c=Object(o.a)("recent-regex","[]"),u=Object(a.a)(c,2),i=u[0],s=u[1],m=r.useMemo((function(){return JSON.parse(i)}),[i]),f=r.useCallback((function(t){if(t&&n.current&&l.current){var r=t.getAttribute("data-regex")||t.value,a=t.getAttribute("data-flags")||n.current.value,c=t.getAttribute("data-marker")||l.current.checked;"string"===typeof c&&(c="true"===c);try{new RegExp(r,a)}catch(u){return}var o={regex:r,flags:a,marker:c};console.log(o),e.registerSource(o),void 0===m.find((function(e){return e.regex===o.regex&&e.flags===o.flags&&e.marker===o.marker}))&&s(JSON.stringify(m.concat([o]))),e.onComplete()}}),[e,m,s]);return r.createElement("div",null,r.createElement("h2",null,"Add a regex"),r.createElement("input",{ref:t,type:"text",placeholder:"regex"}),r.createElement("input",{ref:n,type:"text",placeholder:"flags",defaultValue:"i"}),r.createElement("p",{style:{display:"inline"}},"Is Marker: "),r.createElement("input",{ref:l,type:"checkbox"}),r.createElement("br",null),r.createElement("button",{onClick:function(){return f(t.current)}},"Add"),r.createElement("button",{onClick:function(){return e.onComplete()}},"Close"),r.createElement("h3",null,"Current regexes"),e.sources.map((function(e,t){return r.createElement("p",{key:e.regex+e.marker},r.createElement("span",{style:{fontWeight:"bold"}},t)," - ",e.regex)})),r.createElement("h3",null,"Recent regexes"),m.map((function(e){return r.createElement("input",{"data-regex":e.regex,"data-flags":e.flags,"data-marker":e.marker,key:e.regex+e.flags+e.marker,type:"text",readOnly:!0,value:"/"+e.regex+"/"+e.flags+" (isMarker: "+e.marker+")",style:{width:"100%"},onClick:function(e){return f(e.currentTarget)}})})),r.createElement("h3",null,"Requirements/Tips"),r.createElement("ul",null,r.createElement("li",null,r.createElement("p",null,r.createElement("span",{style:{fontWeight:"bold"}},"time"),", and ",r.createElement("span",{style:{fontWeight:"bold"}},"plot")," are required"," ",r.createElement("a",{href:"https://javascript.info/regexp-groups#named-groups",target:"_blank",rel:"noopener noreferrer"},"named capture groups"),". They inform us how to find the time series data.")),r.createElement("li",null,r.createElement("p",null,r.createElement("span",{style:{fontWeight:"bold"}},"split")," is an optional"," ",r.createElement("a",{href:"https://javascript.info/regexp-groups#named-groups",target:"_blank",rel:"noopener noreferrer"},"named capture group"),". It allows optional splitting of series by some identifier.")),r.createElement("li",null,r.createElement("p",null,"All other matches are captured as metadata, and included in the hover tooltip for each data point.")),r.createElement("li",null,r.createElement("p",null,"The named capture group syntax is as follows: "),r.createElement("pre",null,"(?<time>)",r.createElement("br",null),"(?<plot>)",r.createElement("br",null),"(?<split>)")),r.createElement("li",null,r.createElement("pre",{style:{display:"inline"}},"\\s(?<time>.+?)\\s"),r.createElement("p",{style:{display:"inline"}},"is a named capture group to select"," ",r.createElement("span",{style:{fontWeight:"bold"}},"time")," as all characters between two instances of whitespace."))))}var i=n(41),s=n(42),m=(n(146),["#0f6fc6","#009dd9","#0bd0d9","#10cf9b","#7cca62","#a5c249","#9999ff","#993366","#ffffcc","#ccffff","#660066","#ff8080","#0066cc","#ccccff","#000080","#ff00ff","#ffff00","#0000ff","#800080","#800000","#008080","#0000ff","#f8c000","#f88600","#f83500","#8b723d","#818b3d","#586215"]);function f(e){r.useEffect((function(){}));var t=r.useMemo((function(){var t=e.regexes.map((function(e){var t=new RegExp(e.regex,e.flags);return t._marker=e.marker||!1,t}));return Object(s.a)(e.datasources.map((function(n,r){var l=n.data.split(e.delim).filter((function(e){return t.some((function(t){return t.test(e)}))}));return t.map((function(e,t){var a=r+t,c={},o=!1,u=l.map((function(t){return function(e,t){var n=e.exec(t);if(n&&n.groups&&n.groups.time&&(n.groups.plot||e._marker)){for(var r=n.groups,l=r.time,a=r.plot,c=r.split,o=[],u=1;u<n.length;u++)("undefined"===typeof n[u]||n[u]!==l&&n[u]!==a&&n[u]!==c)&&o.push(n[u]);return{x:l,y:a,split:c,marker:e._marker||!1,meta:o.length>0?o:void 0}}}(e,t)})).map((function(e){if(e)return e.split&&!c[e.split]&&(c[e.split]=!0),!0===e.marker&&(e.y="-1",o=!0),e})).filter((function(e){return void 0!==e}));return 0===Object.keys(c).length&&(c[""]=!0),Object.keys(c).map((function(e,r){var l=a+r;return{label:"".concat(n.name," [").concat(t,"] ").concat(e),fill:!1,showLine:!1===o,borderColor:m[l],backgroundColor:m[l],data:""===e?u:u.filter((function(t){return t&&t.split&&t.split===e}))}}))}))})))}),[e]);return r.createElement("div",{style:{position:"relative",maxHeight:"100vh"}},r.createElement(i.Line,{data:{datasets:t},options:{downsample:{onInit:!1,restoreOriginalData:!1,enabled:!0,threshold:500},animation:{duration:0},tooltips:{callbacks:{label:function(e,t){var n=t.datasets[e.datasetIndex].label||"",r=t.datasets[e.datasetIndex].data[e.index].meta;return n&&(n+=": "),r&&(n+=JSON.stringify(r)+": "),n+=Math.round(100*e.yLabel)/100,n}}},scales:{xAxes:[{type:"time",distribution:"series",offset:!0,ticks:{major:{enabled:!0,fontStyle:"bold"},source:"data",autoSkip:!0,autoSkipPadding:75,maxRotation:0,sampleSize:100}}],yAxes:[{gridLines:{drawBorder:!1},scaleLabel:{display:!1}}]}}}))}function p(e){return r.createElement("div",null,r.createElement("h1",null,"Welcome to Textre!"),r.createElement("p",null,"Textre (pronounced texture) is a tool for extracting time series data from raw text files, and visualizing it on a graph. I built it to help me debug audio video call logs - but feel free to use it for whatever."),r.createElement("h3",null,"Getting Started"),r.createElement("ul",null,r.createElement("li",null,r.createElement("p",null,"First, you'll be asked to select a"," ",r.createElement("span",{style:{fontWeight:"bold"}},"source")," - sources are just raw text files containing the content you want to select and visualize.")),r.createElement("li",null,r.createElement("p",null,"Then you'll define some"," ",r.createElement("span",{style:{fontWeight:"bold"}},"regex")," - regex tells us how to understand your content.")),r.createElement("li",null,r.createElement("p",null,"That's it! You'll be presented with"," ",r.createElement("span",{style:{fontWeight:"bold"}},"the chart")," - the chart is the main view in this app, it shows all your time series data and lets you interact with it.")),r.createElement("li",null,r.createElement("button",{onClick:function(){return e.onComplete()}},"Begin!"))))}n(147);function d(){var e=r.useState(!0),t=Object(a.a)(e,2),n=t[0],l=t[1],o=r.useState(!0),i=Object(a.a)(o,2),s=i[0],m=i[1],d=r.useState(!0),g=Object(a.a)(d,2),E=g[0],h=g[1],b=r.useState([]),x=Object(a.a)(b,2),y=x[0],k=x[1],v=r.useState([]),C=Object(a.a)(v,2),w=C[0],S=C[1],O=r.useCallback((function(e,t){k(y.concat({name:e,data:t}))}),[y]),j=r.useCallback((function(e){S(w.concat([e]))}),[w]);return n?r.createElement(p,{onComplete:function(){return l(!1)}}):s?r.createElement(c,{registerSource:O,onComplete:function(){return m(!1)}}):E?r.createElement(u,{sources:w,registerSource:j,onComplete:function(){return h(!1)}}):r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("span",null,r.createElement("button",{onClick:function(){return m(!0)}},"Add Source [",y.length,"]")),r.createElement("span",null,r.createElement("button",{onClick:function(){return h(!0)}},"Add Regex [",w.length,"]")),r.createElement("span",null,r.createElement("button",{onClick:function(){return S([])}},"Clear Regex"))),r.createElement(f,{datasources:y,regexes:w,delim:"\n"}))}var g=document.getElementById("root");Object(l.render)(r.createElement(d,null),g)},43:function(e,t,n){e.exports=n(148)}},[[43,1,2]]]);
//# sourceMappingURL=main.123efbbe.chunk.js.map